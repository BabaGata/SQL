1. Kolika je prosjecna dnevna, mjesecna i godišnja zarada na Dunlopovim gumama
(za svaki stupac dodati odgovarajuci alias)?
SELECT AVG(CIJENA*PRODANO*12) "GODISNJA", AVG(CIJENA*PRODANO) "MJESECNA",
AVG(CIJENA*PRODANO/30) "DNEVNA" FROM GUME WHERE SIFRA_PRO IN
(SELECT SIFRA_PRO FROM PROIZVODJAC WHERE NAZIV_PRO='DUNLOP'); 


2. Prikazati naziv guma i šifru proizvodaca cije je sjedište u Milanu.
SELECT NAZIV_GUME, SIFRA_PRO FROM GUME WHERE SIFRA_PRO IN
(SELECT SIFRA_PRO FROM PROIZVODJAC WHERE SJEDISTE='MILANO');


3. Prikazati naziv, namjenu i cijenu guma proizvodaca sa šifrom MN, koje imaju
istu namjenu kao gume koje proizvodi Pirelli.
SELECT NAZIV_GUME, NAMJENA, CIJENA FROM GUME WHERE SIFRA_PRO='MN' 
AND NAMJENA IN (SELECT NAMJENA FROM PROIZVODJAC WHERE NAZIV_PRO='PIRELLI');


4. Prikazati naziv gume koja ima najduži naziv.
SELECT NAZIV_GUME FROM GUME WHERE LENGTH(NAZIV_GUME) IN 
(SELECT MAX(LENGTH(NAZIV_GUME)) FROM GUME); 


5. Koja je najprodavanija guma svakog proizvodaca?
SELECT NAZIV_GUME, SIFRA_PRO, PRODANO FROM GUME WHERE (PRODANO, SIFRA_PRO) IN
(SELECT MAX(PRODANO), SIFRA_PRO FROM GUME GROUP BY SIFRA_PRO);

SELECT NAZIV_GUME, SIFRA_PRO, PRODANO FROM GUME WHERE PRODANO IN (SELECT 
MAX(PRODANO) FROM GUME GROUP BY SIFRA_PRO);


6. Koje gume koštaju manje od 40% cijene Excellence guma?
SELECT NAZIV_GUME, CIJENA FROM GUME WHERE CIJENA < (SELECT (CIJENA*0.4) FROM
GUME WHERE NAZIV_GUME='EXCELLENCE');


7. Koliko guma proizvodaca sa šifrom GY košta više od najvece cijene guma koje
proizvodi Dunlop?
SELECT COUNT(NAZIV_GUME) FROM GUME WHERE SIFRA_PRO='GY' AND CIJENA > (SELECT MAX(CIJENA)
FROM GUME WHERE SIFRA_PRO=(SELECT SIFRA_PRO FROM PROIZVODJAC WHERE NAZIV_PRO='DUNLOP'));


8. Prikazati naziv i sjedište proizvodaca koji imaju barem jedne ljetne gume.
SELECT NAZIV_PRO, SJEDISTE FROM PROIZVODJAC WHERE SIFRA_PRO IN 
(SELECT SIFRA_PRO FROM GUME WHERE NAMJENA='LJETNE' GROUP BY SIFRA_PRO 
HAVING COUNT(NAMJENA)>=1);


9. Za svaku zimsku gumu prikazati njen naziv i sjedište njenog proizvodaca.
SELECT NAZIV_GUME, SJEDISTE FROM GUME, PROIZVODJAC WHERE 
GUME.SIFRA_PRO=PROIZVODJAC.SIFRA_PRO AND NAMJENA='ZIMSKE';


10. Prikazati naziv proizvodaca, kao i naziv i cijenu svake njegove gume, ukljucujuci
i proizvodace bez guma.
SELECT NAZIV_PRO, NAZIV_GUME, CIJENA FROM PROIZVODJAC, GUME WHERE 
GUME.SIFRA_PRO(+)=PROIZVODJAC.SIFRA_PRO;


11. Prikazati naziv i cijenu guma te naziv i cijenu njihovih nadklasa, 
za one gume koje su skuplje od svoje neposredne nadklase. 
SELECT POD.NAZIV_GUME "NAZIV_POD", POD.CIJENA "CIJENA_POD", 
NAD.NAZIV_GUME "NAZIV_NAD", NAD.CIJENA "CIJENA_NAD" FROM GUME POD, GUME NAD WHERE 
POD.CIJENA>NAD.CIJENA AND POD.NADKLASA=NAD.SIFRA_GUME;

12. Prikazati prosjecnu cijenu i broj guma cija je zaliha veca od zalihe 
neposredno nadredenih guma.
SELECT AVG(POD.CIJENA), COUNT(POD.SIFRA_GUME) FROM GUME POD, GUME NAD WHERE
POD.ZALIHA>NAD.ZALIHA AND POD.NADKLASA=NAD.SIFRA_GUME;


13. Ispisati naziv gume, namjenu i nadklasu za sve one gume koje su podklasa od gume
CARAT.
SELECT NAZIV_GUME, NAMJENA, NADKLASA FROM GUME WHERE NADKLASA = (SELECT 
SIFRA_GUME FROM GUME WHERE NAZIV_GUME='CARAT');


14. Ispisati naziv gume, namjenu i cijenu onih guma koje imaju manju cijenu od 
najmanje cijene svih all season guma te im je proizvodac isti kao i gumama ciji
naziv završava slovom A.  
SELECT NAZIV_GUME, NAMJENA, CIJENA FROM GUME WHERE CIJENA<(SELECT MIN(CIJENA) 
FROM GUME WHERE NAMJENA='ALL SEASON') AND SIFRA_PRO IN (SELECT SIFRA_PRO FROM 
GUME WHERE NAZIV_GUME LIKE '%A');


15. Koje gume imaju vecu prodaju od prosjecne prodaje svih guma? Sortirati u padajucem redoslijedu prodaje.
SELECT NAZIV_GUME FROM GUME WHERE PRODANO>(SELECT AVG(PRODANO) FROM GUME) ORDER BY PRODANO DESC;


16.
SELECT NAMJENA,
SUM(DECODE(NAZIV_PRO, 'GOODYEAR', PRODANO, 0)) "GOODYEAR",
SUM(DECODE(NAZIV_PRO, 'DUNLOP', PRODANO, 0)) "DUNLOP",
SUM(DECODE(NAZIV_PRO, 'PIRELLI', PRODANO, 0)) "PIRELLI",
SUM(DECODE(NAZIV_PRO, 'MICHELIN', PRODANO, 0)) "MICHELIN",
SUM(PRODANO) "NAJVIŠE PRODANO PO NAMJENI",
SUM (0) "POMOCNI" 
FROM GUME, PROIZVODJAC WHERE 
GUME.SIFRA_PRO=PROIZVODJAC.SIFRA_PRO
GROUP BY NAMJENA
ORDER BY NAMJENA;

BREAK ON POMOCNI

COMPUTE SUM OF 'GOODYEAR' ON POMOCNI
COMPUTE SUM OF 'DUNLOP' ON POMOCNI
COMPUTE SUM OF 'MICHELIN' ON POMOCNI
COMPUTE SUM OF 'PIRELLI' ON POMOCNI
COMPUTE SUM OF 'UKUPNO PO NAMJENI' ON POMOCNI

COLUMN 'GOODYEAR' FORMAT 999,999,999.99
COLUMN 'DUNLOP' FORMAT 999,999,999.99
COLUMN 'MICHELIN' FORMAT 999,999,999.99
COLUMN 'PIRELLI' FORMAT 999,999,999.99
COLUMN 'UKUPNO PO NAMJENI' FORMAT 999,999,999.99


TTITLE CENTER 'IZVJEŠÆE' SKIP CENTER 'o ukupnim zaradama po namjeni guma 
za svakog proizvoðaèa'

COLUMN POMOCNI NOPRINT


17. 
SELECT NAMJENA,
AVG(DECODE(SJEDISTE, 'BUFFALO', ZALIHA, 0)) "BUFFALO",
AVG(DECODE(SJEDISTE, 'AKROM', ZALIHA, 0)) "AKROM",
AVG(DECODE(SJEDISTE, 'MILANO', ZALIHA, 0)) "MILANO",
AVG(DECODE(SJEDISTE, 'OSTALO' ZALIHA, 0)) "OSTALO", --
AVG (0) POMOCNI
FROM GUME, PROIZVODJAC WHERE 
GUME.SIFRA_PRO=PROIZVODJAC.SIFRA_PRO
GROUP BY NAMJENA
ORDER BY NAMJENA;

BREAK ON POMOCNI

COMPUTE AVG OF 'BUFFALO' ON POMOCNI
COMPUTE AVG OF 'AKROM' ON POMOCNI
COMPUTE AVG OF 'MILANO' ON POMOCNI
COMPUTE AVG OF 'OSTALO' ON POMOCNI

COLUMN 'BUFFALO' FORMAT 99.99
COLUMN 'AKROM' FORMAT 99.99
COLUMN 'MILANO' FORMAT 99.99
COLUMN 'OSTALO' FORMAT 99.99

TTITLE CENTER 'PROSJEÈNE ZALIHE' SKIP CENTER 'po lokacijama za pojedine namjene guma'

COLUMN POMOCNI NOPRINT


18.
SELECT NAMJENA,
SUM(DECODE(NAZIV_PRO, 'GOODYEAR', PRODANO, 0)) "GOODYEAR",
SUM(DECODE(NAZIV_PRO, 'DUNLOP', PRODANO, 0)) "DUNLOP",
SUM(DECODE(NAZIV_PRO, 'PIRELLI', PRODANO, 0)) "PIRELLI",
SUM(DECODE(NAZIV_PRO, 'MICHELIN', PRODANO, 0)) "MICHELIN",
SUM(DECODE(NAZIV_PRO, 'SAVA', PRODANO, 0)) "SAVA",
MAX(PRODANO) "NAJVIŠE PRODANO PO NAMJENI",
MAX (0) "POMOCNI" 
FROM GUME, PROIZVODJAC WHERE 
GUME.SIFRA_PRO=PROIZVODJAC.SIFRA_PRO
GROUP BY NAMJENA
ORDER BY NAMJENA;

BREAK ON POMOCNI;

COMPUTE MAX OF 'GOODYEAR' ON POMOCNI
COMPUTE MAX OF 'DUNLOP' ON POMOCNI
COMPUTE MAX OF 'PIRELLI' ON POMOCNI
COMPUTE MAX OF 'MICHELIN' ON POMOCNI
COMPUTE MAX OF 'SAVA' ON POMOCNI
COMPUTE MAX OF 'NAJVIŠE PRODANO PO NAMJENI' ON POMOCNI

COLUMN 'GOODYEAR' FORMAT 99999
COLUMN 'DUNLOP' FORMAT 99999
COLUMN 'PIRELLI' FORMAT 99999
COLUMN 'MICHELIN' FORMAT 99999
COLUMN 'SAVA' FORMAT 99999
COLUMN 'NAJVIŠE PRODANO PO NAMJENI' FORMAT 99999

COLUMN POMOCNI NOPRINT

TTITLE CENTER 'IZVJEŠÆE' SKIP CENTER 'o najprodavanijim gumama 
po namjeni za svakog proizvoðaèa'
BTITLE RIGHT '***************' SKIP RIGHT 'Stranica: 1'











